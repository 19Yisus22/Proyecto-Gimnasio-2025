<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Gestión Usuarios | Administración</title>
<link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='uploads/icon.png') }}">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
<link rel="stylesheet" href="{{ url_for('static', filename='css/styles_admin/style_gestion_usuarios.css') }}">
<script>const ID_USUARIO="{{ session['user']['id_usuario'] if session.get('user') else '' }}";</script>
</head>
<body>

{% include 'navbar.html' %}

<div class="container-central">
  <div class="card-title-center mb-4"><div class="bi bi-people-fill"> Gestionar Usuarios</div></div>

  <div class="card mb-4">
    <div class="card-body">
      <h5>Crear | Editar Usuario</h5>
      <div class="row g-2 mt-3">
        <div class="col-md-2"><input type="text" id="nombreUsuario" class="form-control" placeholder="Nombre"></div>
        <div class="col-md-2"><input type="text" id="apellidoUsuario" class="form-control" placeholder="Apellido"></div>
        <div class="col-md-2"><input type="text" id="cedulaUsuario" class="form-control" placeholder="Cédula"></div>
        <div class="col-md-2"><input type="email" id="correoUsuario" class="form-control" placeholder="Correo"></div>
        <div class="col-md-2"><input type="password" id="contrasenaUsuario" class="form-control" placeholder="Contraseña"></div>
        <div class="col-md-2"><input type="text" id="telefonoUsuario" class="form-control" placeholder="Teléfono"></div>
        <div class="col-md-2"><input type="text" id="direccionUsuario" class="form-control" placeholder="Dirección"></div>
        <div class="col-md-2">
          <select id="generoUsuario" class="form-select">
            <option value="">Seleccionar Género</option>
            <option value="Masculino">Masculino</option>
            <option value="Femenino">Femenino</option>
            <option value="Otro">Otro</option>
          </select>
        </div>
        <div class="col-md-2"><input type="date" id="fechaNacimientoUsuario" class="form-control"></div>
        <div class="col-md-2">
          <select id="metodoPagoUsuario" class="form-select">
            <option value="Efectivo">Efectivo</option>
            <option value="Transferencia">Transferencia</option>
            <option value="Tarjeta">Tarjeta</option>
          </select>
        </div>
        <div class="col-md-2">
          <select id="rolUsuario" class="form-select">
            <option value="">Seleccionar Rol</option>
            <option value="miembro">Miembro</option>
            <option value="entrenador">Entrenador</option>
            <option value="nutricionista">Nutricionista</option>
            <option value="recepcionista">Recepcionista</option>
            <option value="administrador">Administrador</option>
          </select>
        </div>
        <div class="col-md-2">
          <select id="membresiaUsuario" class="form-select">
            <option value="">Membresía Activa</option>
            <option value="true">Sí</option>
            <option value="false">No</option>
          </select>
        </div>
        <div class="col-12 mt-3 text-center">
          <button class="btn btn-success me-2" onclick="guardarUsuario()">Guardar Usuario</button>
          <button class="btn btn-secondary" id="btnCancelar" onclick="cancelarEdicion()" style="display:none;">Cancelar</button>
        </div>
      </div>
    </div>
  </div>

  <div class="card p-3">
    <div class="row g-2 mb-3">
      <div class="col-md-4"><input type="text" id="buscarCedula" class="form-control" placeholder="Buscar por Cédula" oninput="filtrarTabla()"></div>
      <div class="col-md-4">
        <select id="filtroMembresia" class="form-select" onchange="filtrarTabla()">
          <option value="">Filtrar Membresía</option>
          <option value="true">Activa</option>
          <option value="false">Inactiva</option>
        </select>
      </div>
      <div class="col-md-4">
        <select id="filtroRol" class="form-select" onchange="filtrarTabla()">
          <option value="">Filtrar por Rol</option>
          <option value="miembro">Miembro</option>
          <option value="entrenador">Entrenador</option>
          <option value="nutricionista">Nutricionista</option>
          <option value="recepcionista">Recepcionista</option>
          <option value="administrador">Administrador</option>
        </select>
      </div>
    </div>

    <div class="table-responsive">
      <table class="table table-bordered align-middle text-center">
        <thead>
          <tr>
            <th>Nombre</th>
            <th>Apellido</th>
            <th>Cédula</th>
            <th>Correo</th>
            <th>Rol</th>
            <th>Teléfono</th>
            <th>Dirección</th>
            <th>Género</th>
            <th>Método Pago</th>
            <th>Membresía</th>
            <th>Fecha Nacimiento</th>
            <th>Fecha Creación</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody id="tablaUsuarios"></tbody>
      </table>
      <nav><ul id="paginacion" class="pagination justify-content-center"></ul></nav>
    </div>
  </div>
</div>

<div class="footer-space"></div>

<div class="modal fade" id="perfilModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Perfil Completo</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body" id="perfilContenido"></div>
    </div>
  </div>
</div>

<div id="toastContainer" class="position-fixed p-3 top-0 end-0"></div>

{% include 'footer.html' %}

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="{{ url_for('static', filename='js/funtions_admin/gestion_usuarios.js') }}"></script>

</body>
</html>