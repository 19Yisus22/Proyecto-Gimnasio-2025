<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plan Nutricional | Miembros</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles_member/style_progreso_fisico.css') }}">

</head>

{% include 'navbar.html' %}

<body class="bg-gray-50 min-h-screen p-4 md:p-8">
    <div class="max-w-6xl mx-auto">
        <header class="text-center mb-10">
            <div class="card-title-center mb-4"><div class="bi bi-apple me-2"> Plan Nutricional</div></div>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">

            <div class="lg:col-span-1 space-y-6">
                
                <div id="statusAlert" class="hidden p-4 rounded-xl font-medium" role="alert"></div>

                <div class="bg-white p-6 shadow-xl rounded-xl border border-gray-100">
                    <h2 class="text-xl font-semibold mb-4 text-gray-700 flex items-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-blue-500" viewBox="0 0 20 20" fill="currentColor"><path d="M7 3a1 1 0 000 2h6a1 1 0 100-2H7zM4 7a1 1 0 011-1h10a1 1 0 110 2H5a1 1 0 01-1-1zM4 11a1 1 0 011-1h10a1 1 0 110 2H5a1 1 0 01-1-1zM4 15a1 1 0 011-1h10a1 1 0 110 2H5a1 1 0 01-1-1z"/></svg>
                        Mi Progreso y Objetivo
                    </h2>
                    <div id="progressDisplay" class="space-y-4">
                        <p id="currentWeight" class="text-lg text-gray-800">Último Peso: <span class="font-bold text-xl text-blue-600">--</span></p>
                        <div id="goalDisplay" class="p-3 bg-yellow-50 rounded-lg border border-yellow-200">
                            <p class="font-semibold text-yellow-700">Objetivo Actual:</p>
                            <p id="goalDescription" class="text-gray-700 italic">--</p>
                            <p id="goalDeadline" class="text-sm text-gray-500">Fecha Límite: --</p>
                        </div>
                    </div>

                    <h3 class="text-xl font-semibold mt-6 mb-3 text-gray-700 border-t pt-4">Historial de Progreso Físico</h3>
                    <div class="relative h-64 bg-gray-50 p-2 rounded-lg">
                        <canvas id="progressChart"></canvas>
                        <div id="chartLoading" class="absolute inset-0 flex items-center justify-center bg-gray-50/70 text-gray-600 font-medium">Cargando gráfica...</div>
                    </div>
                </div>

                <div class="bg-white p-6 shadow-xl rounded-xl border border-gray-100">
                    <h2 class="text-xl font-semibold mb-4 text-gray-700 flex items-center">
                           <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-green-500" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 2a1 1 0 011 1v1.5a1 1 0 01.447.894L11 6h3a1 1 0 011 1v2.5a1 1 0 01-.447.894L14 11h-3.5a1 1 0 01-.894-.447L9 10H5a1 1 0 01-1-1V6a1 1 0 011-1h3.5a1 1 0 01.894-.447L10 4V3a1 1 0 011-1zM7.5 13a1 1 0 000 2h5a1 1 0 100-2h-5z" clip-rule="evenodd"/></svg>
                        Plan de Nutrición Actual
                    </h2>
                    <div id="nutritionPlanDisplay" class="bg-gray-50 p-4 rounded-lg border border-gray-200 mb-6">
                        <p id="planDescription" class="font-medium text-gray-700">Plan: <span class="font-bold">Cargando...</span></p>
                        <p id="planMacros" class="text-sm text-gray-600">Macros: --</p>
                    </div>

                    <h3 class="text-md font-semibold mb-3 text-gray-700">Ingesta de Hoy</h3>
                    <ul id="intakeList" class="divide-y divide-gray-100 max-h-40 overflow-y-auto bg-white border rounded-lg">
                        <li class="py-2 px-3 text-gray-500 text-sm">Cargando ingesta...</li>
                    </ul>
                </div>
            </div>

            <div class="lg:col-span-2 space-y-6">
                <div class="bg-white p-6 shadow-xl rounded-xl border border-gray-100 h-full flex flex-col">
                    <h2 class="text-2xl font-semibold mb-4 text-gray-700">Chat con tu Nutricionista</h2>
                    
                    <div id="chatMessages" class="bg-gray-100 p-4 flex-grow overflow-y-auto rounded-lg mb-4 space-y-3">
                        <div class="text-center text-gray-500 text-sm">Cargando mensajes...</div>
                    </div>
                    
                    <form id="chatForm" class="flex space-x-2">
                        <input type="text" id="chatInput" placeholder="Escribe un mensaje..." required
                                class="flex-grow p-3 border border-gray-300 rounded-lg focus:ring-purple-500 focus:border-purple-500">
                        <button type="submit" class="bg-purple-600 text-white p-3 rounded-lg font-bold hover:bg-purple-700 transition duration-150 shadow-md">Enviar</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
<footer class="w-100 mt-auto">
    {% include 'footer.html' %}
</footer>
<script src="{{ url_for('static', filename='js/funtions_member/plan_nutricional.js') }}"></script>

</body>
</html>